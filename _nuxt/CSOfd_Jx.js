const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BqnJNToI.js","./B6IApBWP.js","./DoOtwcvV.js"])))=>i.map(i=>d[i]);
import{a6 as R,aa as W,_ as B}from"./B6IApBWP.js";import{t as D}from"./DoOtwcvV.js";const k=/\d/,x=["-","_","/","."];function P(t=""){if(!k.test(t))return t!==t.toLowerCase()}function j(t,s){const n=x,r=[];if(!t||typeof t!="string")return r;let i="",e,o;for(const u of t){const h=n.includes(u);if(h===!0){r.push(i),i="",e=void 0;continue}const f=P(u);if(o===!1){if(e===!1&&f===!0){r.push(i),i=u,e=f;continue}if(e===!0&&f===!1&&i.length>1){const a=i.at(-1);r.push(i.slice(0,Math.max(0,i.length-1))),i=a+u,e=f;continue}}i+=u,e=f,o=h}return r.push(i),r}function F(t){return t?t[0].toUpperCase()+t.slice(1):""}function q(t,s){return t?(Array.isArray(t)?t:j(t)).map(n=>F(s!=null&&s.normalize?n.toLowerCase():n)).join(""):""}function X(t,s){return t?(Array.isArray(t)?t:j(t)).map(n=>n.toLowerCase()).join("-"):""}const w=(t,s)=>{const n=t._conditions;return n.length>0?`(${n.join(` ${s} `)})`:""},N=t=>{const s=[],n={_conditions:s,where(r,i,e){let o;switch(i.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(e)){const u=e.map(h=>S(h)).join(", ");o=`"${String(r)}" ${i.toUpperCase()} (${u})`}else throw new TypeError(`Value for ${i} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(e)&&e.length===2)o=`"${String(r)}" ${i.toUpperCase()} ${S(e[0])} AND ${S(e[1])}`;else throw new Error(`Value for ${i} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(r)}" ${i.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(r)}" ${i.toUpperCase()} ${S(e)}`;break;default:o=`"${String(r)}" ${i} ${S(typeof e=="boolean"?Number(e):e)}`}return s.push(`${o}`),n},andWhere(r){const i=r(N());return s.push(w(i,"AND")),n},orWhere(r){const i=r(N());return s.push(w(i,"OR")),n}};return n},M=(t,s)=>{const n={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},r={__params:n,andWhere(e){const o=e(N());return n.conditions.push(w(o,"AND")),r},orWhere(e){const o=e(N());return n.conditions.push(w(o,"OR")),r},path(e){return r.where("path","=",R(e))},skip(e){return n.offset=e,r},where(e,o,u){return r.andWhere(h=>h.where(String(e),o,u)),r},limit(e){return n.limit=e,r},select(...e){return e.length&&n.selectedFields.push(...e),r},order(e,o){return n.orderBy.push(`"${String(e)}" ${o}`),r},async all(){return s(t,i()).then(e=>e||[])},async first(){return s(t,i({limit:1})).then(e=>e[0]||null)},async count(e="*",o=!1){return s(t,i({count:{field:String(e),distinct:o}})).then(u=>u[0].count)}};function i(e={}){let o="SELECT ";if(e!=null&&e.count)o+=`COUNT(${e.count.distinct?"DISTINCT ":""}${e.count.field}) as count`;else{const h=Array.from(new Set(n.selectedFields));o+=h.length>0?h.map(f=>`"${String(f)}"`).join(", "):"*"}o+=` FROM ${D[String(t)]}`,n.conditions.length>0&&(o+=` WHERE ${n.conditions.join(" AND ")}`),n.orderBy.length>0?o+=` ORDER BY ${n.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const u=(e==null?void 0:e.limit)||n.limit;return u>0&&(n.offset>0?o+=` LIMIT ${u} OFFSET ${n.offset}`:o+=` LIMIT ${u}`),o}return r};function S(t){return`'${String(t).replace(/'/g,"''")}'`}async function Q(t,s=[]){var f;const n=t.__params;(f=n==null?void 0:n.orderBy)!=null&&f.length||(t=t.order("stem","ASC"));const r=await t.orWhere(a=>a.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:i,configs:e}=r.reduce((a,c)=>{var d;if(String(c.stem).split("/").pop()===".navigation"){c.title=((d=c.title)==null?void 0:d.toLowerCase())==="navigation"?"":c.title;const y=c.path.split("/").slice(0,-1).join("/")||"/";a.configs[y]={...c,...c.body}}else a.contents.push(c);return a},{configs:{},contents:[]}),o=a=>({..._(["title",...s])(a),...a.meta,...L(a==null?void 0:a.navigation)?a.navigation:{}}),u=a=>({..._(["title",...s])(a),...L(a==null?void 0:a.navigation)?a.navigation:{}}),h=i.reduce((a,c)=>{var I;const d=c.path.substring(1).split("/"),y=c.stem.split("/"),T=!!((I=y[y.length-1])!=null&&I.match(/([1-9]\d*\.)?index/g)),v=l=>({title:l.title,path:l.path,stem:l.stem,children:[],...u(l)}),p=v(c);if(T){const l=e[p.path];if(typeof(l==null?void 0:l.navigation)<"u"&&(l==null?void 0:l.navigation)===!1)return a;if(c.path!=="/"){const g=v(c);p.children.push(g)}l&&Object.assign(p,o(l))}if(d.length===1){const l=a.find(g=>g.path===p.path&&g.page===!1);return T&&l?Object.assign(l,{page:void 0,children:[...p.children,...l.children]}):a.push(p),a}const A=d.slice(0,-1).reduce((l,g,O)=>{const E="/"+d.slice(0,O+1).join("/"),m=e[E];if(typeof(m==null?void 0:m.navigation)<"u"&&m.navigation===!1)return[];let $=l.find(C=>C.path===E);if(!$){const C=m?o(m):{};$={...C,title:C.title||V(g),path:E,stem:y.slice(0,O+1).join("/"),children:[],page:!1},l.push($)}return $.children},a),b=A.find(l=>l.path===p.path&&l.page===!1);return b?Object.assign(b,{...p,page:void 0,children:[...p.children,...b.children]}):A.push(p),a},[]);return U(h)}function U(t){var n;const s=t;for(const r of s)(n=r.children)!=null&&n.length?U(r.children):delete r.children;return t}function _(t){return s=>(s=s||{},t&&t.length?t.filter(n=>typeof s[n]<"u").reduce((n,r)=>Object.assign(n,{[r]:s[r]}),{}):s)}function L(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}const V=t=>t.split(/[\s-]/g).map(q).join(" "),G=t=>{var n,r;const s=(r=(n=W())==null?void 0:n.ssrContext)==null?void 0:r.event;return M(t,(i,e)=>H(s,i,e))};function Z(t,s){return Y(t,n=>Q(n,s))}async function H(t,s,n){return K(s,n)}async function K(t,s){return await B(()=>import("./BqnJNToI.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(r=>r.loadDatabaseAdapter(t)).then(r=>r.all(s))}function Y(t,s){const n=G(t),r={where(i,e,o){return n.where(String(i),e,o),r},andWhere(i){return n.andWhere(i),r},orWhere(i){return n.orWhere(i),r},order(i,e){return n.order(String(i),e),r},then(i,e){return s(n).then(i,e)},catch(i){return this.then(void 0,i)},finally(i){return this.then(void 0,void 0).finally(i)},get[Symbol.toStringTag](){return"Promise"}};return r}export{Z as a,X as k,q as p,G as q};
